<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GoPark! - New Reservation</title>
    <style>
        /* --- Global High-Tech Theme --- */
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;  
            color: #FFFFFF;
            
            background: 
                linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), 
                url('https://i.imgur.com/your-gopark-image.jpg') no-repeat center center fixed; 
            background-size: cover;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- Navigation & Header --- */
        .header {
            display: flex;
            justify-content: space-between;  
            align-items: center;
            padding: 20px 40px;
            background-color: rgba(10, 25, 40, 0.95);  
            border-bottom: 2px solid #00E0FF;  
            box-shadow: 0 4px 15px rgba(0, 224, 255, 0.1);
        }

        .logo-branding {
            text-align: left;
            line-height: 1.2;
        }

        .logo-title {
            font-family: 'Consolas', 'Courier New', monospace;  
            font-size: 1.8em;  
            margin: 0;
            font-weight: 700;
            color: #FFFFFF;  
            letter-spacing: 3px;  
            text-shadow: 
                0 0 5px #00E0FF,  
                0 0 10px rgba(0, 224, 255, 0.5);
        }

        .logo-tagline {
            font-family: 'Consolas', 'Courier New', monospace;  
            font-size: 0.8em;  
            margin: 0;
            font-weight: 300;
            color: #B0E0FF;
            letter-spacing: 1px;
        }

        .nav {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .nav a {
            color: #B0E0FF;  
            text-decoration: none;
            font-weight: 500;
            font-size: 1.05em;
            transition: color 0.3s, text-shadow 0.3s;
        }

        .nav a:hover {
            color: #00E0FF;  
            text-shadow: 0 0 5px #00E0FF;  
        }

        .nav a.logout {
            color: #FF4136; 
            border: 1px solid #FF4136; 
            padding: 5px 10px; 
            border-radius: 3px; 
            text-decoration: none; 
            transition: background-color 0.3s; 
        }

        .nav a.logout:hover {
            background-color: rgba(255, 65, 54, 0.1); 
        }

        /* ------------------------------------------------------------------- */
        /* --- MAIN CONTENT LAYOUT --- */
        /* ------------------------------------------------------------------- */

        .main-content {
            flex-grow: 1;
            display: flex;
            padding: 50px 50px;  
        }

        /* Layout for Login/Signup (2-column asymmetric) */
        .main-content:not(.centered-content) {
            justify-content: space-around;
            align-items: center;  
        }

        /* Layout for About/Services/Contact (1-column centered) */
        .main-content.centered-content {
            flex-direction: column;
            align-items: center;
            max-width: 1100px;
            margin: 0 auto;
        }

        /* --- HIGH-TECH SKELETAL BOX DESIGN (Applies to all forms/content) --- */
        .auth-box {
            background-color: rgba(10, 25, 40, 0.5);  
            padding: 35px 50px;
            border-radius: 5px;
            border: 1px solid #00E0FF;  
            box-shadow: 0 0 20px rgba(0, 224, 255, 0.8);  
            max-width: 420px;
            width: 100%;
            text-align: center;
        }

        /* Larger box for content pages */
        .content-box {
            max-width: 100%;
            text-align: left;
            padding: 40px 60px;
        }

        /* *** RESERVATION PAGE BOX STYLES *** */
        .reservation-form-area {
            background-color: rgba(10, 25, 40, 0.5);  
            padding: 35px 50px;
            border-radius: 5px;
            border: 2px solid #00E0FF;  
            box-shadow: 0 0 25px rgba(0, 224, 255, 0.8); 
            text-align: left;
            min-width: 400px;
        }

        .parking-map-area {
            background-color: rgba(10, 25, 40, 0.7); 
            border: 2px solid #00E0FF;  
            box-shadow: 0 0 25px rgba(0, 224, 255, 0.8);
            padding: 30px;
            border-radius: 5px;
            text-align: center;
        }

        .auth-box h3 {
            margin-top: 0;
            color: #00E0FF;
            font-weight: 600;
            letter-spacing: 1px;
            border-bottom: 1px dashed #33FFFF;  
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* --- Form Fields (Inputs) --- */
        .auth-box input[type="text"],
        .auth-box input[type="password"],
        .auth-box input[type="email"],
        .auth-box input[type="tel"],
        .reservation-form-area input[type="text"],
        .reservation-form-area input[type="email"],
        .reservation-form-area input[type="date"] {
            width: calc(100% - 22px);
            padding: 12px;
            margin-bottom: 15px;
            border: none;  
            border-bottom: 2px solid #00E0FF;  
            background-color: transparent;  
            color: white;
            border-radius: 0;  
            box-shadow: none;
            transition: border-bottom-color 0.3s;
        }

        .auth-box input:focus,
        .reservation-form-area input:focus {
            border-bottom-color: #33FFFF;
            outline: none;
            box-shadow: 0 2px 5px rgba(0, 224, 255, 0.4);  
        }

        /* --- Button Styling (Neon Border/Fill) --- */
        .auth-box button,
        .reservation-form-area button {
            width: 100%;
            padding: 14px;
            border: 2px solid #00E0FF;  
            border-radius: 3px;
            background-color: rgba(0, 224, 255, 0.1);  
            color: #00E0FF;  
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0, 224, 255, 0.6);
            transition: background-color 0.2s, box-shadow 0.2s, color 0.2s;
        }

        .auth-box button:hover,
        .reservation-form-area button:hover {
            background-color: #00E0FF;  
            color: #0A1928;  
            box-shadow: 0 0 20px #33FFFF;
        }

        /* --- Reservation Dashboard Specific Styles --- */ 
        .reservation-container { 
            display: flex; 
            gap: 20px;
            width: 100%; 
            margin-left: auto; 
            margin-right: auto; 
            padding: 20px 0; 
            align-items: flex-start; 
            flex-wrap: wrap; 
            justify-content: center; 
        } 
        
        .reservation-form-area { 
            flex: 1; 
            min-width: 400px; 
        } 
        
        .parking-map-area { 
            flex: 1.5; 
        } 
        
        .form-title { 
            color: #00E0FF; 
            font-size: 1.5em; 
            margin-bottom: 20px; 
            text-align: left; 
            border-bottom: 1px dashed #33FFFF; 
            padding-bottom: 10px; 
        } 
        
        .form-row { 
            display: flex; 
            gap: 15px; 
            margin-bottom: 15px; 
        } 
        
        .form-group { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
        } 
        
        .form-label { 
            color: #B0E0FF; 
            font-size: 0.9em; 
            margin-bottom: 5px; 
            text-align: left; 
        } 
        
        .form-input { 
            width: 100%; 
            padding: 12px; 
            border: none; 
            border-bottom: 2px solid #00E0FF; 
            background-color: transparent; 
            color: white; 
            border-radius: 0; 
            box-shadow: none; 
            transition: border-bottom-color 0.3s; 
        } 
        
        .form-input:focus { 
            border-bottom-color: #33FFFF; 
            outline: none; 
            box-shadow: 0 2px 5px rgba(0, 224, 255, 0.4); 
        } 
        
        .time-note { 
            color: #90A4AE; 
            font-size: 0.8em; 
            margin-top: 3px; 
            text-align: left; 
            font-style: italic; 
        } 
        
        .vehicle-type-buttons { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 15px; 
        } 
        
        .vehicle-btn { 
            flex: 1; 
            padding: 12px; 
            border: 2px solid #00E0FF; 
            background-color: rgba(0, 224, 255, 0.1); 
            color: #00E0FF; 
            border-radius: 5px; 
            cursor: pointer; 
            text-align: center; 
            transition: all 0.3s; 
            font-weight: bold; 
        } 
        
        .vehicle-btn:hover { 
            background-color: rgba(0, 224, 255, 0.2); 
        } 
        
        .vehicle-btn.active { 
            background-color: #00E0FF; 
            color: #0A1928; 
            box-shadow: 0 0 15px rgba(0, 224, 255, 0.8); 
        } 
        
        /* White calendar and time icons */ 
        input[type="date"]::-webkit-calendar-picker-indicator, 
        input[type="time"]::-webkit-calendar-picker-indicator { 
            filter: invert(1); 
            cursor: pointer; 
        } 
        
        input[type="date"]::-webkit-calendar-picker-indicator:hover, 
        input[type="time"]::-webkit-calendar-picker-indicator:hover { 
            opacity: 0.8; 
        } 
        
        .parking-grid { 
            display: grid; 
            grid-template-columns: repeat(6, 1fr); 
            gap: 8px; 
            padding: 20px; 
            border: 1px solid rgba(0, 224, 255, 0.4); 
            background-color: rgba(0, 0, 0, 0.2); 
            margin-bottom: 20px; 
        } 
        
        .parking-lane { 
            grid-column: 1 / -1; 
            height: 30px; 
            background-color: rgba(0, 224, 255, 0.05); 
            border: 1px dashed rgba(0, 224, 255, 0.3); 
            margin: 10px 0; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: #B0E0FF; 
            font-size: 0.8em; 
        } 
        
        .parking-spot { 
            width: 60px; 
            height: 35px; 
            line-height: 35px; 
            border-radius: 3px; 
            cursor: pointer; 
            font-size: 0.7em; 
            font-weight: bold; 
            color: white; 
            transition: transform 0.1s, box-shadow 0.2s; 
            position: relative; 
        } 
        
        .spot-available { 
            background-color: rgba(0, 255, 0, 0.2); 
            border: 1px solid #0F0; 
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.4); 
            color: #0F0; 
        } 
        
        .spot-available:hover { 
            transform: scale(1.05); 
            box-shadow: 0 0 10px #0F0; 
        } 
        
        .spot-reserved { 
            background-color: rgba(255, 0, 0, 0.2); 
            border: 1px solid #F00; 
            color: #F00; 
            cursor: not-allowed; 
            opacity: 0.8; 
            pointer-events: none; 
        } 
        
        .spot-selected { 
            background-color: rgba(0, 224, 255, 0.8); 
            border: 2px solid #33FFFF; 
            box-shadow: 0 0 15px #33FFFF; 
            color: #0A1928; 
            transform: scale(1.1); 
            z-index: 10; 
        } 
        
        .selected-info { 
            background-color: rgba(10, 25, 40, 0.9); 
            border: 1px solid #00E0FF; 
            padding: 15px; 
            margin-top: 20px; 
            font-size: 1em; 
            text-align: center; 
        } 
        
        .selected-info strong { 
            color: #33FFFF; 
        } 
        
        .pricing-info { 
            background-color: rgba(255, 193, 7, 0.1); 
            border: 1px solid #FFC107; 
            color: #FFC107; 
            padding: 10px; 
            border-radius: 5px; 
            margin-top: 10px; 
            font-size: 0.9em; 
        } 
        
        .action-group { 
            display: flex; 
            gap: 15px; 
            margin-top: 20px; 
        } 
        
        .action-group button { 
            flex: 1; 
        } 
        
        .action-group .cancel-button { 
            background-color: transparent; 
            color: #FF4136; 
            border: 2px solid #FF4136; 
            box-shadow: none; 
        } 
        
        .action-group .cancel-button:hover { 
            background-color: rgba(255, 65, 54, 0.1); 
            color: #FF4136; 
            box-shadow: 0 0 10px #FF4136; 
        } 
        
        .auth-box button { 
            width: auto; 
        } 
        
        .vehicle-warning { 
            background-color: rgba(255, 193, 7, 0.1); 
            border: 1px solid #FFC107; 
            color: #FFC107; 
            padding: 10px; 
            border-radius: 5px; 
            font-size: 0.85em; 
            margin-bottom: 15px; 
            text-align: center; 
        } 
        
        .legend { 
            display: flex; 
            justify-content: center; 
            gap: 20px; 
            margin-top: 15px; 
            margin-bottom: 10px; 
        } 
        
        .legend-item { 
            display: flex; 
            align-items: center; 
            gap: 8px; 
            font-size: 0.85em; 
        } 
        
        .legend-color { 
            width: 20px; 
            height: 20px; 
            border-radius: 3px; 
            border: 1px solid; 
        } 
        
        .legend-available { 
            background-color: rgba(0, 255, 0, 0.2); 
            border-color: #0F0; 
        } 
        
        .legend-reserved { 
            background-color: rgba(255, 0, 0, 0.2); 
            border-color: #F00; 
        } 
        
        .legend-selected { 
            background-color: rgba(0, 224, 255, 0.8); 
            border-color: #33FFFF; 
        } 

        /* --- New Styles for Duration Selection --- */
        .duration-selection {
            margin-top: 15px;
            padding: 15px;
            background-color: rgba(0, 224, 255, 0.05);
            border: 1px solid rgba(0, 224, 255, 0.3);
            border-radius: 5px;
        }

        .duration-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .duration-option {
            flex: 1;
            min-width: 80px;
            padding: 10px;
            border: 2px solid #00E0FF;
            background-color: rgba(0, 224, 255, 0.1);
            color: #00E0FF;
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-weight: bold;
        }

        .duration-option:hover {
            background-color: rgba(0, 224, 255, 0.2);
        }

        .duration-option.active {
            background-color: #00E0FF;
            color: #0A1928;
            box-shadow: 0 0 10px rgba(0, 224, 255, 0.8);
        }

        .custom-duration {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .custom-duration input {
            flex: 1;
            padding: 10px;
            border: none;
            border-bottom: 2px solid #00E0FF;
            background-color: transparent;
            color: white;
            text-align: center;
        }

        .custom-duration span {
            color: #B0E0FF;
            font-size: 0.9em;
        }

        .cost-calculation {
            margin-top: 15px;
            padding: 10px;
            background-color: rgba(0, 224, 255, 0.1);
            border-radius: 5px;
            text-align: center;
        }

        .cost-calculation strong {
            color: #33FFFF;
            font-size: 1.1em;
        }

        .error-message {
            background-color: rgba(255, 65, 54, 0.2);
            color: #FF4136;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            border: 1px solid #FF4136;
            text-align: center;
        }

        .date-warning {
            background-color: rgba(255, 193, 7, 0.1);
            border: 1px solid #FFC107;
            color: #FFC107;
            padding: 8px;
            border-radius: 5px;
            font-size: 0.8em;
            margin-top: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo-branding">
            <h1 class="logo-title">GoPark!</h1>
            <p class="logo-tagline">No Stress. Just Park.</p>
        </div>
        <nav class="nav">
            <a href="/" class="logout">Logout</a>
        </nav>
    </header>

    <div class="main-content centered-content">
        <div class="reservation-container">
            <div class="reservation-form-area auth-box content-box">
                <h3 class="form-title">Reservation Form</h3>
                
                {% if error %}
                    <div class="error-message">
                        {{ error }}
                    </div>
                {% endif %}

                <form action="/reservation" method="post" id="reservationForm">
                    <h4 style="color: #B0E0FF; margin-top: 10px; text-align: left;">Personal Information</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" class="form-input" placeholder="Enter full name" name="full_name" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" class="form-input" placeholder="+63 912 345 6789" name="phone_number" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" placeholder="your.email@example.com" name="email" required>
                    </div>

                    <h4 style="color: #B0E0FF; margin-top: 20px; text-align: left;">Vehicle Information</h4>
                    <div class="vehicle-warning">
                        This parking area is designed for light vehicles only. Oversized vehicles (e.g., trucks, buses, and similar units) are prohibited due to space and safety limitations.
                    </div>
                    <div class="vehicle-type-buttons">
                        <div class="vehicle-btn active" data-vehicle-type="car">Car üöó</div>
                        <div class="vehicle-btn" data-vehicle-type="motorcycle">Motorcycle üèçÔ∏è</div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Vehicle Type</label>
                            <input type="text" class="form-input" placeholder="e.g., Sedan, SUV, Hatchback" name="vehicle_type" id="vehicle_type" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">License Plate</label>
                            <input type="text" class="form-input" placeholder="e.g., ABC 1234" name="plate_number" required>
                        </div>
                    </div>

                    <h4 style="color: #B0E0FF; margin-top: 20px; text-align: left;">Reservation Details</h4>
                    <div class="form-group">
                        <label class="form-label">Reservation Date</label>
                        <input type="date" class="form-input" name="reservation_date" id="reservation_date" required>
                        <div class="date-warning" id="date-warning" style="display: none;">
                            Please select today or a future date
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Arrival Time</label>
                            <input type="time" class="form-input" name="arrival_time" id="arrival_time" required>
                            <div class="time-note">When you plan to arrive at the parking facility</div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Departure Time</label>
                            <input type="time" class="form-input" name="departure_time" id="departure_time" required readonly>
                            <div class="time-note">Calculated based on your parking duration</div>
                        </div>
                    </div>

                    <!-- Duration Selection Section -->
                    <div class="duration-selection">
                        <h4 style="color: #B0E0FF; margin-top: 0; text-align: left;">Parking Duration</h4>
                        
                        <div class="duration-options">
                            <div class="duration-option active" data-duration="60">1 hour</div>
                            <div class="duration-option" data-duration="120">2 hours</div>
                            <div class="duration-option" data-duration="180">3 hours</div>
                            <div class="duration-option" data-duration="240">4 hours</div>
                            <div class="duration-option" data-duration="360">6 hours</div>
                            <div class="duration-option" data-duration="480">8 hours</div>
                        </div>
                        
                        <div class="custom-duration">
                            <input type="number" id="custom-hours" min="0" max="23" placeholder="Hours" value="1">
                            <span>hours</span>
                            <input type="number" id="custom-minutes" min="0" max="59" placeholder="Minutes" value="0">
                            <span>minutes</span>
                        </div>
                        
                        <input type="hidden" id="total_minutes" name="total_minutes" value="60">
                        
                        <div class="cost-calculation">
                            Estimated Cost: <strong id="estimated-cost">‚Ç±50.00</strong>
                            <div style="font-size: 0.8em; margin-top: 5px; color: #B0E0FF;">
                                Billed in 15-minute increments
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Parking Spot</label>
                        <input type="text" class="form-input" placeholder="Select from map ‚Üí" name="parking_slot" id="parking_slot" readonly required>
                    </div>

                    <div class="action-group" style="margin-top: 40px;">
                        <button type="submit" class="auth-box-button" style="width: 100%;">NEXT: PAYMENT</button>
                    </div>
                </form>
            </div>
            <div class="parking-map-area">
                <h4 style="color: #00E0FF; margin-top: 0;">Parking Layout</h4>
                <div class="parking-grid">
                    <!-- Row 1: 6 spots -->
                    <div class="parking-spot spot-available" data-spot="A-01">A-01</div>
                    <div class="parking-spot spot-available" data-spot="A-02">A-02</div>
                    <div class="parking-spot spot-reserved" data-spot="A-03">A-03</div>
                    <div class="parking-spot spot-available" data-spot="A-04">A-04</div>
                    <div class="parking-spot spot-available" data-spot="A-05">A-05</div>
                    <div class="parking-spot spot-available" data-spot="A-06">A-06</div>

                    <!-- Row 2: 6 spots -->
                    <div class="parking-spot spot-available" data-spot="B-01">B-01</div>
                    <div class="parking-spot spot-reserved" data-spot="B-02">B-02</div>
                    <div class="parking-spot spot-available" data-spot="B-03">B-03</div>
                    <div class="parking-spot spot-available" data-spot="B-04">B-04</div>
                    <div class="parking-spot spot-available" data-spot="B-05">B-05</div>
                    <div class="parking-spot spot-reserved" data-spot="B-06">B-06</div>

                    <!-- Row 3: 6 spots -->
                    <div class="parking-spot spot-available" data-spot="C-01">C-01</div>
                    <div class="parking-spot spot-available" data-spot="C-02">C-02</div>
                    <div class="parking-spot spot-available" data-spot="C-03">C-03</div>
                    <div class="parking-spot spot-reserved" data-spot="C-04">C-04</div>
                    <div class="parking-spot spot-available" data-spot="C-05">C-05</div>
                    <div class="parking-spot spot-available" data-spot="C-06">C-06</div>

                    <!-- Driving Lane -->
                    <div class="parking-lane">DRIVING LANE</div>

                    <!-- Row 4: 6 spots -->
                    <div class="parking-spot spot-available" data-spot="D-01">D-01</div>
                    <div class="parking-spot spot-available" data-spot="D-02">D-02</div>
                    <div class="parking-spot spot-available" data-spot="D-03">D-03</div>
                    <div class="parking-spot spot-available" data-spot="D-04">D-04</div>
                    <div class="parking-spot spot-reserved" data-spot="D-05">D-05</div>
                    <div class="parking-spot spot-available" data-spot="D-06">D-06</div>

                    <!-- Row 5: 6 spots -->
                    <div class="parking-spot spot-available" data-spot="E-01">E-01</div>
                    <div class="parking-spot spot-available" data-spot="E-02">E-02</div>
                    <div class="parking-spot spot-reserved" data-spot="E-03">E-03</div>
                    <div class="parking-spot spot-available" data-spot="E-04">E-04</div>
                    <div class="parking-spot spot-available" data-spot="E-05">E-05</div>
                    <div class="parking-spot spot-available" data-spot="E-06">E-06</div>

                    <!-- Row 6: 3 spots (to make total 33) -->
                    <div class="parking-spot spot-available" data-spot="F-01">F-01</div>
                    <div class="parking-spot spot-available" data-spot="F-02">F-02</div>
                    <div class="parking-spot spot-available" data-spot="F-03">F-03</div>
                </div>

                <!-- Parking Legend -->
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color legend-available"></div>
                        <span>Available - Ready for reservation</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-reserved"></div>
                        <span>Occupied - Currently in use</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-selected"></div>
                        <span>Selected - Your chosen spot</span>
                    </div>
                </div>

                <div class="selected-info">
                    Your Selected Spot: <strong id="selected-spot-display">None</strong>
                    <div id="pricing-display" class="pricing-info">
                        Parking Rates:<br>
                        <strong id="car-price">Car: ‚Ç±50 per hour</strong><br>
                        <strong id="motorcycle-price">Motorcycle: ‚Ç±30 per hour</strong>
                        <div style="font-size: 0.8em; margin-top: 5px;">
                            Minimum charge: 15 minutes
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vehicle type selection
        document.addEventListener('DOMContentLoaded', function() {
            const vehicleButtons = document.querySelectorAll('.vehicle-btn');
            const vehicleTypeInput = document.getElementById('vehicle_type');
            
            // Parking rates in Philippine Peso (per hour only)
            const parkingRates = {
                car: 50,      // ‚Ç±50 per hour
                motorcycle: 30 // ‚Ç±30 per hour
            };
            
            let currentVehicleType = 'car';
            let currentRate = parkingRates.car;

            // Set minimum date to today
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('reservation_date').min = formattedDate;

            vehicleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Remove active class from all buttons
                    vehicleButtons.forEach(btn => btn.classList.remove('active'));
                    
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Update vehicle type input placeholder and current rate
                    currentVehicleType = this.getAttribute('data-vehicle-type');
                    currentRate = parkingRates[currentVehicleType];
                    
                    if (currentVehicleType === 'car') {
                        vehicleTypeInput.value = 'Car';
                        vehicleTypeInput.placeholder = 'e.g., Sedan, SUV, Hatchback';
                    } else if (currentVehicleType === 'motorcycle') {
                        vehicleTypeInput.value = 'Motorcycle';
                        vehicleTypeInput.placeholder = 'e.g., Scooter, Sport Bike, Cruiser';
                    }
                    
                    // Update pricing display
                    updatePricingDisplay();
                    calculateCost();
                });
            });
            
            // Update pricing display
            function updatePricingDisplay() {
                const carPriceDisplay = document.getElementById('car-price');
                const motorcyclePriceDisplay = document.getElementById('motorcycle-price');
                
                carPriceDisplay.textContent = `Car: ‚Ç±${parkingRates.car} per hour`;
                motorcyclePriceDisplay.textContent = `Motorcycle: ‚Ç±${parkingRates.motorcycle} per hour`;
            }
            
            // Duration selection functionality
            const durationOptions = document.querySelectorAll('.duration-option');
            const customHoursInput = document.getElementById('custom-hours');
            const customMinutesInput = document.getElementById('custom-minutes');
            const totalMinutesInput = document.getElementById('total_minutes');
            const estimatedCostDisplay = document.getElementById('estimated-cost');
            const departureTimeInput = document.getElementById('departure_time');
            const arrivalTimeInput = document.getElementById('arrival_time');
            const reservationDateInput = document.getElementById('reservation_date');
            const dateWarning = document.getElementById('date-warning');
            
            // Set default arrival time to current time + 30 minutes
            const now = new Date();
            now.setMinutes(now.getMinutes() + 30); // Add 30 minutes buffer
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            arrivalTimeInput.value = `${hours}:${minutes}`;
            updateDepartureTime(); // Set initial departure time
            
            // Date validation
            reservationDateInput.addEventListener('change', function() {
                const selectedDate = new Date(this.value);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                if (selectedDate < today) {
                    dateWarning.style.display = 'block';
                    this.style.borderBottomColor = '#FF4136';
                } else {
                    dateWarning.style.display = 'none';
                    this.style.borderBottomColor = '#00E0FF';
                }
                
                // If selected date is today, validate time
                if (selectedDate.toDateString() === today.toDateString()) {
                    validateTimeForToday();
                }
            });
            
            // Time validation for today
            function validateTimeForToday() {
                const now = new Date();
                const currentTime = now.getHours() * 60 + now.getMinutes();
                const [arrivalHours, arrivalMinutes] = arrivalTimeInput.value.split(':').map(Number);
                const selectedTime = arrivalHours * 60 + arrivalMinutes;
                
                if (selectedTime < currentTime) {
                    // Auto-adjust to current time + 30 minutes
                    const adjustedTime = new Date(now.getTime() + 30 * 60000);
                    const adjustedHours = adjustedTime.getHours().toString().padStart(2, '0');
                    const adjustedMinutes = adjustedTime.getMinutes().toString().padStart(2, '0');
                    arrivalTimeInput.value = `${adjustedHours}:${adjustedMinutes}`;
                    updateDepartureTime();
                }
            }
            
            arrivalTimeInput.addEventListener('change', function() {
                const selectedDate = new Date(reservationDateInput.value);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                if (selectedDate.toDateString() === today.toDateString()) {
                    validateTimeForToday();
                }
                updateDepartureTime();
            });
            
            durationOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove active class from all options
                    durationOptions.forEach(opt => opt.classList.remove('active'));
                    
                    // Add active class to clicked option
                    this.classList.add('active');
                    
                    // Set custom inputs based on selection
                    const minutes = parseInt(this.getAttribute('data-duration'));
                    const hours = Math.floor(minutes / 60);
                    const mins = minutes % 60;
                    
                    customHoursInput.value = hours;
                    customMinutesInput.value = mins;
                    
                    calculateCost();
                    updateDepartureTime();
                });
            });
            
            // Custom duration input handlers
            customHoursInput.addEventListener('input', function() {
                // Ensure we're not using preset duration
                durationOptions.forEach(opt => opt.classList.remove('active'));
                calculateCost();
                updateDepartureTime();
            });
            
            customMinutesInput.addEventListener('input', function() {
                // Allow any minutes from 0-59
                let minutes = parseInt(this.value) || 0;
                if (minutes < 0) this.value = 0;
                if (minutes > 59) this.value = 59;
                
                // Ensure we're not using preset duration
                durationOptions.forEach(opt => opt.classList.remove('active'));
                calculateCost();
                updateDepartureTime();
            });
            
            // Calculate cost based on duration and vehicle type (billed in 15-minute increments)
            function calculateCost() {
                const hours = parseInt(customHoursInput.value) || 0;
                const minutes = parseInt(customMinutesInput.value) || 0;
                const totalMinutes = (hours * 60) + minutes;
                
                // Update total minutes hidden field
                totalMinutesInput.value = totalMinutes;
                
                // Calculate cost (billed in 15-minute increments)
                let cost = 0;
                if (totalMinutes > 0) {
                    // Convert to quarter hours (15-minute increments)
                    const quarterHours = Math.ceil(totalMinutes / 15);
                    const exactHours = quarterHours * 0.25; // Each quarter hour = 0.25 hours
                    cost = exactHours * currentRate;
                }
                
                // Display formatted cost
                estimatedCostDisplay.textContent = `‚Ç±${cost.toFixed(2)}`;
            }
            
            // Update departure time based on arrival time and duration
            function updateDepartureTime() {
                const arrivalTime = arrivalTimeInput.value;
                if (!arrivalTime) return;
                
                const hours = parseInt(customHoursInput.value) || 0;
                const minutes = parseInt(customMinutesInput.value) || 0;
                
                // Parse arrival time
                const [arrivalHours, arrivalMinutes] = arrivalTime.split(':').map(Number);
                
                // Calculate departure time
                let departureHours = arrivalHours + hours;
                let departureMinutes = arrivalMinutes + minutes;
                
                // Handle minute overflow
                if (departureMinutes >= 60) {
                    departureHours += Math.floor(departureMinutes / 60);
                    departureMinutes = departureMinutes % 60;
                }
                
                // Handle hour overflow (24-hour format)
                departureHours = departureHours % 24;
                
                // Format to HH:MM
                const formattedHours = departureHours.toString().padStart(2, '0');
                const formattedMinutes = departureMinutes.toString().padStart(2, '0');
                
                departureTimeInput.value = `${formattedHours}:${formattedMinutes}`;
            }
            
            // Parking spot selection functionality
            const parkingSpots = document.querySelectorAll('.parking-spot.spot-available');
            const selectedSpotDisplay = document.getElementById('selected-spot-display');
            const parkingSlotInput = document.getElementById('parking_slot');
            
            parkingSpots.forEach(spot => {
                spot.addEventListener('click', function() {
                    // Remove selected class from all spots
                    document.querySelectorAll('.parking-spot').forEach(s => s.classList.remove('spot-selected'));
                    
                    // Add selected class to clicked spot
                    this.classList.add('spot-selected');
                    
                    // Update display and input field
                    const spotId = this.getAttribute('data-spot');
                    selectedSpotDisplay.textContent = spotId;
                    parkingSlotInput.value = spotId;
                });
            });
            
            // Form validation
            const form = document.getElementById('reservationForm');
            form.addEventListener('submit', function(e) {
                // Client-side validation
                const selectedDate = new Date(reservationDateInput.value);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                if (selectedDate < today) {
                    e.preventDefault();
                    alert('Cannot select a date in the past. Please choose today or a future date.');
                    return false;
                }
                
                if (selectedDate.toDateString() === today.toDateString()) {
                    const now = new Date();
                    const currentTime = now.getHours() * 60 + now.getMinutes();
                    const [arrivalHours, arrivalMinutes] = arrivalTimeInput.value.split(':').map(Number);
                    const selectedTime = arrivalHours * 60 + arrivalMinutes;
                    
                    if (selectedTime < currentTime) {
                        e.preventDefault();
                        alert('Cannot select a time that has already passed for today. Please choose a future time.');
                        return false;
                    }
                }
                
                if (!parkingSlotInput.value) {
                    e.preventDefault();
                    alert('Please select a parking spot from the map.');
                    return false;
                }
                
                const plateNumber = document.querySelector('input[name="plate_number"]').value;
                if (!plateNumber) {
                    e.preventDefault();
                    alert('License plate is required.');
                    return false;
                }
                
                const vehicleType = document.querySelector('input[name="vehicle_type"]').value;
                if (!vehicleType) {
                    e.preventDefault();
                    alert('Vehicle type is required.');
                    return false;
                }
                
                // Validate duration
                const hours = parseInt(customHoursInput.value) || 0;
                const minutes = parseInt(customMinutesInput.value) || 0;
                if (hours === 0 && minutes === 0) {
                    e.preventDefault();
                    alert('Please select a valid parking duration.');
                    return false;
                }
                
                if (hours === 0 && minutes < 15) {
                    e.preventDefault();
                    alert('Minimum parking duration is 15 minutes.');
                    return false;
                }
                
                return true;
            });
            
            // Initialize
            updatePricingDisplay();
            calculateCost();
        });
    </script>
</body>
</html>